The value of MAX should be between 0 and L*L. 
